grayscale로 로드
이진화
경계검출은 소벨필터를 사용
허프변환을 이용한 선 검출 (소벨과 허프는 악보가 기울어진 것을 보정하기 위한 것이므로 오선을 추출하는 것과는 상관없음)
이미지의 가로길이의 70%이상이 검은픽셀이라면 오선으로 인식
오선값들을 이용해 악보에서 오선제거
모폴로지연산의 열기연산을 이용하여 오선을 제거하고 생긴 빈공간을 자연스럽게 매꿈 - 모폴로지연산에는 침식, 팽창, 열기, 닫기 등이 있다.
레이블링을 이용한 보표제거 1차 레이블링시 오선을 제거하지 않은 상태에서 해야 구간이 잘 잡힘
1차 레이블링을 통해 얻은 오선의 영역들을 마스크영역으로 정하고 원래이미지에서 마스크를 이용한 연산을 통해 보표를 제거한다.
보표를 제거한 이미지에서 2차 레이블링을 하고 템플릿매칭을 이용해 음표와 비음표로 나눈다.(음자리표, 박자표, 마디표만 주로 있을것으로 예상)



grayscale로 로드
이진화
5선좌표 추출
5선제거
이진화
모폴로지연산을 이용한 음표 추출(침식과 팽창을 여러번 반복) 실제로는 커널크기를 2x2로 생성 후 침식 1번만 진행
템플릿매칭을 이용한 음표의 머리좌표 추출 (threshold = 0.65가 적합, template 이미지는 실제 악보사이즈보다 작아야함)
5선의 y좌표값들과 비교하여 계이름 추출
템플릿 이미지로 추출한 note들을 악보에 맞는 순서로 정리(악보의 흐름대로 note들의 y값의 좌표의 순서를 이용하여 순서 정리)



보표 제거(5선들의 값을 제외한 나머지영역을 bitwise_and를 통해 제거)
5선의 맨아래와 맨위의 중간값을 구해 그 값까지 관심영역으로 표시(y는 처음부터 끝까지)
템플릿매칭을 이용한 음표의 머리좌표 추출(템플릿이미지의 사이즈와 악보이미지의 음표의 사이즈가 같아야 추출되는 것 같음)
5선의 좌표와 머리좌표와 비교하여 계이름 추출